# Case Study: MFA Token Resync â€“ Microsoft Authenticator

## Incident Summary
**User Report:** User reported repeated "Invalid Code" errors when attempting to authenticate using the Microsoft Authenticator mobile app. As a result, the user was blocked from accessing all Microsoft 365 services due to failed MFA verification.

---

## Environment
* Identity Provider: Microsoft Entra ID (formerly Azure AD)
* Software: Microsoft Authenticator Mobile App
* Services Impacted: Microsoft 365 (Outlook, Teams, SharePoint)

## Symptoms
* MFA codes generated by the app were consistently rejected as invalid.
* User was unable to complete the login process despite entering the correct password.
* The issue persisted across multiple login attempts and different browsers.

## Troubleshooting Steps
1. **Identity Verification:** Verified the user's identity following standard security protocols (verifying employee ID/manager) before modifying security settings.
2. **Verification of Error:** Confirmed with the user that password authentication was successful, but the failure occurred specifically at the MFA prompt.
3. **Portal Review:** Checked the Entra ID (Azure AD) sign-in logs; confirmed multiple "MFA Denied" entries with "Result detail: Invalid code" errors.
4. **MFA Reset:** Accessed the Microsoft Entra admin center and performed a "Require re-register MFA" action for the user's account.
5. **Registration Cleanup:** Directed the user to delete the existing account profile within their Microsoft Authenticator app to prevent token conflicts.
6. **Re-enrollment:** Guided the user through the `aka.ms/mfasetup` process to re-register their mobile device and establish a new secure token.

## Root Cause
**MFA Token Desynchronization.** The internal clock or security token within the Microsoft Authenticator app became out of sync with the Entra ID authentication server, causing the time-based one-time passwords (TOTP) to be invalid upon arrival.

## Resolution
* **Action:** Revoked existing MFA sessions and required the user to perform a fresh registration of the Microsoft Authenticator app.
* **Result:** The new registration established a synchronized secure token between the mobile device and the cloud identity provider.
* **Confirmation:** User successfully completed a test login and gained full access to Microsoft 365 services.

## Verification
- [x] User successfully completed the MFA setup process.
- [x] MFA prompts are functioning correctly and accepting codes.
- [x] Access to Microsoft 365 services has been fully restored.

---

## Skills Demonstrated
* MFA Troubleshooting
* Microsoft Entra ID (Azure AD) Administration
* Identity Verification Procedures
* Security Best Practices
* User Guidance and Communication
* ServiceNow Documentation
